{"ast":null,"code":"import _objectSpread from\"C:/Users/ADMIN/Desktop/agro/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useAuth}from'../context/AuthContext';import'./AdminDashboard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminDashboard=()=>{const[users,setUsers]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const{token}=useAuth();useEffect(()=>{const fetchUsers=async()=>{try{const response=await fetch('http://localhost:8000/users/',{headers:{'Authorization':\"Bearer \".concat(token)}});if(!response.ok){throw new Error(\"Error: \".concat(response.status));}const data=await response.json();setUsers(data);setLoading(false);}catch(err){setError(err instanceof Error?err.message:'An unknown error occurred');setLoading(false);}};fetchUsers();},[token]);const toggleUserStatus=async(userId,isActive)=>{try{const response=await fetch(\"http://localhost:8000/users/\".concat(userId),{method:'PATCH',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},body:JSON.stringify({is_active:!isActive})});if(!response.ok){throw new Error(\"Error: \".concat(response.status));}// Update the local state\nsetUsers(users.map(user=>user.id===userId?_objectSpread(_objectSpread({},user),{},{is_active:!isActive}):user));}catch(err){setError(err instanceof Error?err.message:'An unknown error occurred');}};const deleteUser=async userId=>{if(!window.confirm('Are you sure you want to delete this user?')){return;}try{const response=await fetch(\"http://localhost:8000/users/\".concat(userId),{method:'DELETE',headers:{'Authorization':\"Bearer \".concat(token)}});if(!response.ok){throw new Error(\"Error: \".concat(response.status));}// Remove the user from the local state\nsetUsers(users.filter(user=>user.id!==userId));}catch(err){setError(err instanceof Error?err.message:'An unknown error occurred');}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"admin-loading\",children:\"Loading users...\"});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-error\",children:[\"Error: \",error]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-dashboard\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Admin Dashboard\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Total Users\"}),/*#__PURE__*/_jsx(\"p\",{children:users.length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Active Users\"}),/*#__PURE__*/_jsx(\"p\",{children:users.filter(user=>user.is_active).length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Admins\"}),/*#__PURE__*/_jsx(\"p\",{children:users.filter(user=>user.is_admin).length})]})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"User Management\"}),/*#__PURE__*/_jsx(\"div\",{className:\"user-table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"user-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Username\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Role\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.map(user=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:user.username}),/*#__PURE__*/_jsx(\"td\",{children:user.email}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"status-badge \".concat(user.is_active?'active':'inactive'),children:user.is_active?'Active':'Inactive'})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"role-badge \".concat(user.is_admin?'admin':'user'),children:user.is_admin?'Admin':'User'})}),/*#__PURE__*/_jsxs(\"td\",{className:\"action-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:user.is_active?'deactivate-btn':'activate-btn',onClick:()=>toggleUserStatus(user.id,user.is_active),children:user.is_active?'Deactivate':'Activate'}),/*#__PURE__*/_jsx(\"button\",{className:\"delete-btn\",onClick:()=>deleteUser(user.id),children:\"Delete\"})]})]},user.id))})]})})]});};export default AdminDashboard;","map":{"version":3,"names":["React","useState","useEffect","useAuth","jsx","_jsx","jsxs","_jsxs","AdminDashboard","users","setUsers","loading","setLoading","error","setError","token","fetchUsers","response","fetch","headers","concat","ok","Error","status","data","json","err","message","toggleUserStatus","userId","isActive","method","body","JSON","stringify","is_active","map","user","id","_objectSpread","deleteUser","window","confirm","filter","className","children","length","is_admin","username","email","onClick"],"sources":["C:/Users/ADMIN/Desktop/agro/frontend/src/components/AdminDashboard.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport './AdminDashboard.css';\n\ninterface User {\n  id: string;\n  username: string;\n  email: string;\n  is_active: boolean;\n  is_admin: boolean;\n}\n\nconst AdminDashboard: React.FC = () => {\n  const [users, setUsers] = useState<User[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const { token } = useAuth();\n\n  useEffect(() => {\n    const fetchUsers = async () => {\n      try {\n        const response = await fetch('http://localhost:8000/users/', {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n\n        if (!response.ok) {\n          throw new Error(`Error: ${response.status}`);\n        }\n\n        const data = await response.json();\n        setUsers(data);\n        setLoading(false);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'An unknown error occurred');\n        setLoading(false);\n      }\n    };\n\n    fetchUsers();\n  }, [token]);\n\n  const toggleUserStatus = async (userId: string, isActive: boolean) => {\n    try {\n      const response = await fetch(`http://localhost:8000/users/${userId}`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({ is_active: !isActive })\n      });\n\n      if (!response.ok) {\n        throw new Error(`Error: ${response.status}`);\n      }\n\n      // Update the local state\n      setUsers(users.map(user => \n        user.id === userId ? { ...user, is_active: !isActive } : user\n      ));\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'An unknown error occurred');\n    }\n  };\n\n  const deleteUser = async (userId: string) => {\n    if (!window.confirm('Are you sure you want to delete this user?')) {\n      return;\n    }\n\n    try {\n      const response = await fetch(`http://localhost:8000/users/${userId}`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`Error: ${response.status}`);\n      }\n\n      // Remove the user from the local state\n      setUsers(users.filter(user => user.id !== userId));\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'An unknown error occurred');\n    }\n  };\n\n  if (loading) {\n    return <div className=\"admin-loading\">Loading users...</div>;\n  }\n\n  if (error) {\n    return <div className=\"admin-error\">Error: {error}</div>;\n  }\n\n  return (\n    <div className=\"admin-dashboard\">\n      <h1>Admin Dashboard</h1>\n      <div className=\"admin-stats\">\n        <div className=\"stat-card\">\n          <h3>Total Users</h3>\n          <p>{users.length}</p>\n        </div>\n        <div className=\"stat-card\">\n          <h3>Active Users</h3>\n          <p>{users.filter(user => user.is_active).length}</p>\n        </div>\n        <div className=\"stat-card\">\n          <h3>Admins</h3>\n          <p>{users.filter(user => user.is_admin).length}</p>\n        </div>\n      </div>\n      \n      <h2>User Management</h2>\n      <div className=\"user-table-container\">\n        <table className=\"user-table\">\n          <thead>\n            <tr>\n              <th>Username</th>\n              <th>Email</th>\n              <th>Status</th>\n              <th>Role</th>\n              <th>Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {users.map(user => (\n              <tr key={user.id}>\n                <td>{user.username}</td>\n                <td>{user.email}</td>\n                <td>\n                  <span className={`status-badge ${user.is_active ? 'active' : 'inactive'}`}>\n                    {user.is_active ? 'Active' : 'Inactive'}\n                  </span>\n                </td>\n                <td>\n                  <span className={`role-badge ${user.is_admin ? 'admin' : 'user'}`}>\n                    {user.is_admin ? 'Admin' : 'User'}\n                  </span>\n                </td>\n                <td className=\"action-buttons\">\n                  <button \n                    className={user.is_active ? 'deactivate-btn' : 'activate-btn'}\n                    onClick={() => toggleUserStatus(user.id, user.is_active)}\n                  >\n                    {user.is_active ? 'Deactivate' : 'Activate'}\n                  </button>\n                  <button \n                    className=\"delete-btn\"\n                    onClick={() => deleteUser(user.id)}\n                  >\n                    Delete\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n};\n\nexport default AdminDashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}